<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†Œì›ë¹„ëˆ„2</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sancreek&display=swap" rel="stylesheet">
    

</head>
<body>
    <div class="background"></div>
    <div class="text-container">
        <span class="text-bottom">Wish Soap</span>
        <span class="text-top">Wish Soap</span>
    </div>
    <div id="custom-cursor"></div>
    <div class="video-container">
        <img id="soap-video" src="assets/video/handsoap.gif" alt="ë¹„ëˆ„ GIF">
    </div>
    <div class="wish-container">
        <input type="text" id="wish-input" placeholder="ì†Œì›ì„ ì…ë ¥í•˜ì„¸ìš”..." maxlength="50">
        <button id="wish-button">ì†Œì› ë¹Œê¸°</button>
        <p id="wish-message" style="display: none;">3ì´ˆê°„ ë¹„ëˆ„ë¥¼ ë¬¸ì§€ë¥´ì„¸ìš”</p>
    </div>
    <div class="soap-button">
    <a href="/assets/html/wish.html">
        <img id="soap-icon" src="assets/images/soapbutton.png" alt="ë¹„ëˆ„ ë²„íŠ¼">
    </a>
</div>

</body>

<!-- ğŸ”¹ ë§ˆìš°ìŠ¤ ì»¤ì„œ ë”°ë¼ë‹¤ë‹ˆëŠ” ê¸°ëŠ¥ -->
<script>
    const cursor = document.querySelector("#custom-cursor");

    document.addEventListener("mousemove", (e) => {
        cursor.style.left = `${e.clientX}px`;
        cursor.style.top = `${e.clientY}px`;
    });
</script>

<!-- ğŸ”¹ ë¬¸ì§€ë¥¼ ë•Œ í…ìŠ¤íŠ¸ê°€ ë‚˜ì˜¤ê³ , 3ì´ˆê°„ ë¬¸ì§€ë¥´ë©´ ì•Œë¦¼ í‘œì‹œ ê¸°ëŠ¥ (ëª¨ë°”ì¼ í„°ì¹˜ ì¶”ê°€) -->
<script>
    const video = document.getElementById("soap-video");
    const messages = ["bubble", "pop", "blob", "?", "plop"];
    const textBubbles = [];
    let isScrubbing = false; 
    let scrubTimer;
    let scrubStartTime;

    // ğŸŸ¢ ëª¨ë°”ì¼ í„°ì¹˜ ì§€ì› ì¶”ê°€
    const eventType = "ontouchmove" in window ? "touchmove" : "mousemove";

    video.addEventListener(eventType, (e) => {
        if (!isScrubbing) {
            isScrubbing = true;
            scrubStartTime = Date.now();
            startScrubCheck();
        }

        let clientX, clientY;
        if (e.touches) {
            clientX = e.touches[0].clientX;
            clientY = e.touches[0].clientY;
        } else {
            clientX = e.clientX;
            clientY = e.clientY;
        }

        const rect = video.getBoundingClientRect();
        const mouseX = clientX - rect.left;
        const mouseY = clientY - rect.top;
        const videoWidth = rect.width;
        const videoHeight = rect.height;

        const minX = videoWidth * 0.3;
        const maxX = videoWidth * 0.6;
        const minY = videoHeight * 0.2;
        const maxY = videoHeight * 0.8;

        if (mouseX > minX && mouseX < maxX && mouseY > minY && mouseY < maxY) { 
            if (Math.random() > 0.9) { 
                createTextBubble(mouseX, mouseY, rect);
            }
        }
    });

    video.addEventListener("mouseleave", resetScrub);
    video.addEventListener("mouseup", resetScrub);
    video.addEventListener("touchend", resetScrub); // í„°ì¹˜ ì¢…ë£Œ ì‹œ ì´ˆê¸°í™”

    function startScrubCheck() {
        scrubTimer = setInterval(() => {
            let elapsedTime = Date.now() - scrubStartTime;
            if (elapsedTime >= 4000) { // 3ì´ˆ ë™ì•ˆ ë¬¸ì§€ë¥´ë©´ ì•Œë¦¼ í‘œì‹œ
                showAlert();
                resetScrub();
            }
        }, 1000);
    }

    function resetScrub() {
        clearInterval(scrubTimer);
        isScrubbing = false;
    }

    function showAlert() {
        const randomMessage = alertMessages[Math.floor(Math.random() * alertMessages.length)];
        alert(randomMessage);
    }

    function createTextBubble(x, y, rect) {
        const bubble = document.createElement("div");
        bubble.classList.add("text-bubble");
        bubble.innerText = messages[Math.floor(Math.random() * messages.length)]; 

        let offsetX, offsetY, safePosition = false;
        let attempts = 0;

        while (!safePosition && attempts < 10) { 
            offsetX = (Math.random() - 0.5) * 320;
            offsetY = (Math.random() - 0.5) * 320; 

            let newX = rect.left + x + offsetX;
            let newY = rect.top + y + offsetY;

            safePosition = textBubbles.every(b => { 
                let distance = Math.sqrt((b.x - newX) ** 2 + (b.y - newY) ** 2);
                return distance > 50; 
            });

            attempts++; 
        }

        bubble.style.left = `${rect.left + x + offsetX}px`; 
        bubble.style.top = `${rect.top + y + offsetY}px`; 

        document.body.appendChild(bubble); 

        textBubbles.push({ x: rect.left + x + offsetX, y: rect.top + y + offsetY });

        setTimeout(() => {
            bubble.classList.add("show");
        }, 50);

        setTimeout(() => {
            bubble.classList.remove("show");
            setTimeout(() => {
                bubble.remove();
                textBubbles.shift(); 
            }, 500);
        }, 1000);
    }
</script>

<!-- ğŸ”¹ ë™ì˜ìƒì´ ì„œì„œíˆ ë‚˜íƒ€ë‚˜ëŠ” ê¸°ëŠ¥ -->
<script>
    window.addEventListener("load", () => {
        document.querySelector(".video-container").classList.add("show");
    });
</script>
<script>document.getElementById("wish-button").addEventListener("click", function () {
    const wishInput = document.getElementById("wish-input");
    const wishMessage = document.getElementById("wish-message");

    if (wishInput.value.trim() === "") {
        alert("ì†Œì›ì„ ì…ë ¥í•˜ì„¸ìš”!");
        return;
    }

    // âœ… ê¸°ì¡´ ì €ì¥ëœ ì†Œì› ê°€ì ¸ì˜¤ê¸°
    let wishes = JSON.parse(localStorage.getItem("wishes")) || [];

    // âœ… ìƒˆë¡œìš´ ì†Œì› ì¶”ê°€
    wishes.push(wishInput.value.trim());  

    // ì—…ë°ì´íŠ¸ëœ ë¦¬ìŠ¤íŠ¸ ë‹¤ì‹œ ì €ì¥
    localStorage.setItem("wishes", JSON.stringify(wishes));

    //  ì…ë ¥ì°½ ìˆ¨ê¸°ê¸° ë° 3ì´ˆ ë©”ì‹œì§€ í‘œì‹œ
    wishInput.style.display = "none";
    document.getElementById("wish-button").style.display = "none";
    wishMessage.style.display = "block";

    // ëœë¤ ë©”ì‹œì§€ ë°°ì—´ ì¶”ê°€
    const wishMessages = [
        "ê°„ì ˆíˆ ë¹Œë©´ ì´ë£¨ì–´ì§ˆ ê±°ì˜ˆìš”.",
        "ì–¼í† ë‹¹í† í•˜ì§€ ì•ŠëŠ” ì†Œì›ì…ë‹ˆë‹¤.",
        "ë” ê°„ì ˆíˆ ì‹¹ì‹¹ ë¹„ì„¸ìš”.",
        "2ì£¼ ì•ˆì— ì´ë£¨ì–´ì§ˆ ê±°ì˜ˆìš”."
    ];

    let isScrubbing = false; 
        let scrubStartTime;
        let scrubTimer;
        const eventType = "ontouchmove" in window ? "touchmove" : "mousemove";

        // ğŸ”¹ ë¹„ëˆ„ë¥¼ ë¬¸ì§€ë¥´ê¸° ì‹œì‘í•˜ë©´ íƒ€ì´ë¨¸ ì‹œì‘
        video.addEventListener(eventType, (e) => {
            if (!isScrubbing) {
                isScrubbing = true;
                scrubStartTime = Date.now();
                startScrubCheck();
            }
        });

        // ğŸ”¹ 3ì´ˆ ë™ì•ˆ ë¬¸ì§€ë¥´ë©´ ëœë¤ ë©”ì‹œì§€ í‘œì‹œ
        function startScrubCheck() {
            scrubTimer = setInterval(() => {
                let elapsedTime = Date.now() - scrubStartTime;
                if (elapsedTime >= 3000) {
                    showRandomMessage();
                    resetScrub();
                }
            }, 1000);
        }

        // ğŸ”¹ ë¬¸ì§€ë¥´ê¸°ë¥¼ ë©ˆì¶”ë©´ íƒ€ì´ë¨¸ ì´ˆê¸°í™”
        function resetScrub() {
            clearInterval(scrubTimer);
            isScrubbing = false;
        }

        // ğŸ”¹ ëœë¤ ë©”ì‹œì§€ í‘œì‹œ í›„ ìƒˆë¡œê³ ì¹¨
        function showRandomMessage() {
            const randomMessage = wishMessages[Math.floor(Math.random() * wishMessages.length)];
            alert(randomMessage);
            location.reload();
        }

        // ğŸ”¹ ë§ˆìš°ìŠ¤ë¥¼ ë–¼ê±°ë‚˜ í„°ì¹˜ ì¢…ë£Œ ì‹œ ì´ˆê¸°í™”
        video.addEventListener("mouseleave", resetScrub);
        video.addEventListener("mouseup", resetScrub);
        video.addEventListener("touchend", resetScrub);
    });
</script>


</html>
